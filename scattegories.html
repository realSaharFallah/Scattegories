<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Didact+Gothic&family=Poppins:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200" />
    <link href="https://fonts.googleapis.com/css2?family=Nunito:ital,wght@0,200..1000;1,200..1000&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="stilark.css">
    <title>Answers</title>
    <style>
        #welcome{
            cursor: pointer;
        }
        #rulebook{
            font-family: 'Nunito';
            color: white;
            border: white solid 2px;
            width: 0;
            padding: 20px;
            overflow-y: auto; /* Can scroll */
            scrollbar-color: white grey;
            z-index: 0;
            opacity: 0;
            max-height: 96%;
        }

        #rulebook h1{
            line-height: 15px;
            font-family: Arial, Helvetica, sans-serif;
            font-style: bold;
            padding-bottom: 35px;
            font-size: 46px;
            border-bottom: white solid 1px;
            font-weight:600;
            margin: 10px;
        }

        #rulebook p {
            font-size: 14px;  
            line-height: 25px;
            margin: 10px;
        }

        #rulebook h2{
            line-height: 30px;
            margin: 10px;
        }

        #rulebook img{
            width: 100%;
            margin: 10px;
        }

    @media(max-width:850px){
    
    body{
        transition: background-color 1s ease;
    }

    #whiteBox{
        display: flex;
        flex-direction: column;
        padding-right: 50px;
    }
    #quizTable{
        margin:20px auto;
        width: 60%;
    }
    #rulebook{
        margin-bottom:20px !important;
        width: 90% !important;
        min-height: 600px;

    }
    }

    @media(max-width:600px){
        nav{
            font-size: 10px;
        }

        body{
            background-color: black;
        }
        header{
            background-color: black;
        }
        
        .welcomecontainer{
            margin: 0 auto;
        }
        
    }
    @media(max-width:400px){
        #welcome{
            font-size: 20px;

    }
    }
    </style>
</head>
<body style="background-color: black;">
    <header>
        <nav>
            <a href="aboutus.html">About us</a>
        </nav>
    </header>

    <h1 class="welcome-text" id="welcome" style="max-width: 80%; position: relative; left: 0;"></h1>


    <h1>Answers</h1>

    <div id="whiteBox" style="width:0px; height: 0px; margin: 0 auto;">
    <table id="quizTable" style="opacity: 0;">
        <!-- First row -->
        <tr>
            <td>
                <div style="display: flex;">
                    <p id="letterCircle"></p>
                </div>
            </td>  
            <td colspan="2">
                <div id="timeContainer"> 
                    <p class="score" style="margin-right: 20px;"></p>
                </div>                
            </td> 
        </tr>

        <!-- Second row -->
        <tr id="thin-row">
            <td id="secondRow" style="border:#f0f0f0 solid 1px; font-size: 15px; text-align: center; width: 100%; color: grey;" colspan="3"></td> <!-- colspan is number of solumns that it spans  -->
        </tr>
        
        <!-- Third row (12 sub-rows with 2 columns each) -->
        <div style="overflow-y: auto;">
        <tbody id="thirdRow"></tbody>
        </div>    
    </table>
    <div id="rulebook">
        <p style="margin-bottom: 20px;">Scattegories</p>
        <h1>Rulebook</h1>

        <h2>Each round you will get a letter and 12 categories.</h2>
        <h2> Answer each category with a word or phrase starting with that letter.</h2>

        <img src="Media/example1.png" alt="Picture of an example of two cattegories starting with D">

        <h2>Then the computer evalutes your answers and give you points.</h2>
        <h2>Each correct answer recieves 1 point and wrong answers receive 0 point. </h2>

        <p > The computer may sometimes yield false negatives. If you encounter any issues or have suggestions, use the "Contact Us" option.</p>
        <img style="padding-bottom: 20px; border-bottom: grey solid 1px;" src="Media/example2.png" alt="One correct and one wrong answer ">

        <p style="margin-bottom: 20px;">Guidelines for</p>
        <h1>Scoring</h1>

        <h2 >The word "The" does not count for letter T.</h2>
        <p>For example, The Mother is not valid </p>
        <p >The same is true for the words A and An</p>

        <h2 >Avoid descriptive adjectives unless they are part of a common phrase.</h2>
        <p > Ask yourself: is the adjective really important?</p>

    </div>
    </div>


    <script>
        const rulebook = document.getElementById("rulebook")
        let header = document.querySelector("header")
        header.style.opacity = '1'

        const whiteBox = document.getElementById('whiteBox');
        const quizTable = document.getElementById('quizTable')
        setTimeout(function() {
        whiteBox.style.width = '95%'
        whiteBox.style.height = '85%'
        quizTable.style.width = '100%'
        quizTable.style.margin = '20px'
        quizTable.style.height = '100%'
        quizTable.style.zIndex  = "1"
        quizTable.style.opacity = "1"
        rulebook.style.width = '55%'
        rulebook.style.height = "100%"
        rulebook.style.zIndex = "1"
        rulebook.style.opacity = "1"
        rulebook.style.margin = "20px"
        

        }, 1000);

        let welcomeText = document.getElementById("welcome")
        welcome.addEventListener("click",function(){
            window.location.href="welcome.html"
        })
        // Retrieve the username from local storage
        const username = localStorage.getItem("username");

        welcomeText.textContent = "Welcome, " + username + "!"

        welcomeText.style.position = "absolute"
        welcomeText.style.fontSize = "20px"
        welcomeText.style.fontWeight = "normal"
        welcomeText.style.top = '15px'

        welcomeText.style.paddingTop = '0px'
        welcomeText.style.left = '20px'
        welcomeText.style.marginLeft = '20px'
        welcomeText.style.zIndex = 2



        // Retrieve the letter from local storage
        const letter = localStorage.getItem("letter").toLowerCase();

        const letterCircle = document.getElementById("letterCircle")
        letterCircle.innerHTML = letter

        let secondRow =  document.getElementById("secondRow")
        secondRow.innerHTML = "Answer each category with a word or phrase starting with the letter " + letter

        const scoreElement = document.querySelector(".score")


        console.log(letter)

        // Retrieve answers from local storage based on the username
        const answers = JSON.parse(localStorage.getItem(username));

        // Get the table body to insert answers
        const tableBody = document.getElementById('thirdRow');
        let i = 0

            // Iterate through the answers
            for (const category in answers) {
                i++
                const answer = answers[category];

                // Create a new row for each answer
                var row = document.createElement('tr');
                row.setAttribute("id",i)


                // Create cells for category and answer
                const categoryCell = document.createElement('td');
                const answerCell = document.createElement('td');


                // Set the text content of cells
                categoryCell.textContent = "  " + i + ". " + category;
                categoryCell.style.paddingLeft = "20px"
                answerCell.textContent = answer;

                // Append cells to the row
                row.appendChild(categoryCell);
                row.appendChild(answerCell);

                const pointCell = document.createElement("td")
                pointCell.id = "pointCell_"+i
                pointCell.style.backgroundColor = "red"              
                pointCell.style.padding = "10px"              
                pointCell.style.width = "10%"              
                pointCell.style.textAlign= "center"              

                row.appendChild(pointCell);

                // Append the row to the table body
                tableBody.appendChild(row);
            }

let g = 0
let totalPoints = 0     
// Function to check if a category name has the word "Types" and fetch data from the API
async function checkCategoriesWithAPI(answers) {
    // Iterate through the answers
    for (const category in answers) {
        g++

        const currentPointCell = document.getElementById("pointCell_"+g)
        
        const answer = answers[category].toLowerCase();
        console.log("Category:", category, "Answer:", answer);

        if (answer.toLowerCase().startsWith(letter)) {
        // Check if the category name contains the word "Types"
        if (category.toLowerCase().includes("types")) {
            // Extracting the category name as the third word
            const categoryName = category.split(' ')[2];
            console.log("Category Name:", categoryName);

            // Constructing the API URL
            const apiUrl = `https://api.datamuse.com/words?rel_gen=${categoryName}`;
            console.log("API URL:", apiUrl);
            
            // Fetch data from the API
            const response = await fetch(apiUrl);
            
                const data = await response.json();
                console.log("API Response:", data);
                let points = 0;

                // Traverse the data array
                for (let i = 0; i < data.length; i++) {
                    let word = data[i].word;
                    // Check if the word matches the answer
                    if (word === answer) {
                        // Do something with the matched word
                        currentPointCell.style.background = "green"
                        console.log("Matched Word:", word);
                        points++
                        totalPoints += points
                    }
                }
            currentPointCell.textContent = points;

        }
        // Check if the category name contains the word "Associated"
        else if (category.toLowerCase().includes("associated")) {
            // Extracting the category name as the fourth word
            const categoryName = category.split(' ')[3];
            console.log("Category Name:", categoryName);

            // Constructing the API URL
            const apiUrl = `https://api.datamuse.com/words?rel_trg=${categoryName}`;
            console.log("API URL:", apiUrl);
            
            // Fetch data from the API
            const response = await fetch(apiUrl);
            const data = await response.json();
            console.log("API Response:", data);

            let points = 0;


                // Traverse the data array
                for (let i = 0; i < data.length; i++) {
                    let word = data[i].word
                    // Check if the word matches the answer
                    if (word === answer) {
                        console.log("Matched Word:", word);
                        currentPointCell.style.background = "green"
                        points++
                        totalPoints += points
                    }
                }
            currentPointCell.textContent = points;

        } else if (category.toLowerCase().includes("parts")){
            // Extracting the category name as the first word
            const categoryName = category.split(' ')[0];
            console.log("Category Name:", categoryName);

            // Constructing the API URL
            const apiUrl = `https://api.datamuse.com/words?rel_com=${categoryName}`;
            console.log("API URL:", apiUrl);
            
            // Fetch data from the API
            const response = await fetch(apiUrl);
                const data = await response.json();
                console.log("API Response:", data);
            let points = 0
                // Traverse the data array
                for (let i = 0; i < data.length; i++) {
                    let word = data[i].word;
                    // Check if the word matches the answer
                    if (word === answer) {
                        // Do something with the matched word
                        console.log("Matched Word:", word);
                        currentPointCell.style.background = "green"
                        points++
                        totalPoints += points
                    }
                }
            currentPointCell.textContent = points;

        } else if (category.toLowerCase().includes("describe")){
            // Extracting the category name as the fourth word
            const categoryName = category.split(' ')[3];
            console.log("Category Name:", categoryName);

            // Constructing the API URL
            const apiUrl = `https://api.datamuse.com/words?rel_jjb=${categoryName}`;
            console.log("API URL:", apiUrl);
            
            // Fetch data from the API
            const response = await fetch(apiUrl);
                const data = await response.json();
                console.log("API Response:", data);
            let points = 0
                // Traverse the data array
                for (let i = 0; i < data.length; i++) {
                    let word = data[i].word;
                    // Check if the word matches the answer
                    if (word === answer) {
                        // Do something with the matched word
                        console.log("Matched Word:", word);
                        currentPointCell.style.background = "green"
                        points++
                        totalPoints += points
                    }
                }
            currentPointCell.textContent = points;

        }else if(category.toLowerCase().includes("ending")){
            // Extracting the category name as the fourth word
            const categoryName = category.split(' ')[3].toLowerCase();
            console.log("Category Name:", categoryName);

            // Constructing the API URL
            const apiUrl = `https://api.datamuse.com/words?sp=${letter}*${categoryName}`;
            console.log("API URL:", apiUrl);
            
            // Fetch data from the API
            const response = await fetch(apiUrl);
                const data = await response.json();
                console.log("API Response:", data);
            let points = 0
                // Traverse the data array
                for (let i = 0; i < data.length; i++) {
                    let word = data[i].word;
                    // Check if the word matches the answer
                    if (word === answer) {
                        // Do something with the matched word
                        console.log("Matched Word:", word);
                        currentPointCell.style.background = "green"
                        points++
                        totalPoints += points
                    }
                }
            currentPointCell.textContent = points;
        }else{
            // Extracting the category name as the first word
            const categoryName = category.split(' ')[0];
            console.log("Category Name:", categoryName);

            // Constructing the API URL
            const apiUrl = `https://api.datamuse.com/words?rel_jja=${categoryName}`;
            console.log("API URL:", apiUrl);
            
            // Fetch data from the API
            const response = await fetch(apiUrl);
                const data = await response.json();
                console.log("API Response:", data);
            let points = 0
                // Traverse the data array
                for (let i = 0; i < data.length; i++) {
                    let word = data[i].word;
                    // Check if the word matches the answer
                    if (word === answer) {
                        // Do something with the matched word
                        console.log("Matched Word:", word);
                        points++
                        totalPoints += points
                        currentPointCell.style.background = "green"
                    }
                }
            currentPointCell.textContent = points;

        }
    }else{
        currentPointCell.textContent = "0";

    }
    }
    scoreElement.textContent = `Total Points: ${totalPoints}`
}



        // Call the function to check categories with the API
        checkCategoriesWithAPI(answers);

    </script>
</body>
</html>